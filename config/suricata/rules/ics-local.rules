# ============================================================================
# OT SOC-in-a-Box â€” ICS/SCADA Suricata Rules
# ============================================================================

# --- Modbus Write Operations (Exploitation / Impact) ---
alert tcp any any -> any any (msg:"ICS Modbus Write Single Coil"; flow:to_server,established; content:"|05|"; offset:7; depth:1; sid:9000001; rev:2;)
alert tcp any any -> any any (msg:"ICS Modbus Write Single Register"; flow:to_server,established; content:"|06|"; offset:7; depth:1; sid:9000002; rev:2;)
alert tcp any any -> any any (msg:"ICS Modbus Write Multiple Coils"; flow:to_server,established; content:"|0F|"; offset:7; depth:1; sid:9000003; rev:2;)
alert tcp any any -> any any (msg:"ICS Modbus Write Multiple Registers"; flow:to_server,established; content:"|10|"; offset:7; depth:1; sid:9000004; rev:2;)

# --- Modbus Read Operations (Reconnaissance) ---
alert tcp any any -> any any (msg:"ICS Modbus Read Coils"; flow:to_server,established; content:"|01|"; offset:7; depth:1; sid:9000010; rev:1;)
alert tcp any any -> any any (msg:"ICS Modbus Read Input Registers"; flow:to_server,established; content:"|04|"; offset:7; depth:1; sid:9000011; rev:1;)

# --- Modbus Diagnostics (Device Fingerprinting / DoS) ---
alert tcp any any -> any any (msg:"ICS Modbus Diagnostics Request"; flow:to_server,established; content:"|08|"; offset:7; depth:1; sid:9000020; rev:1;)
alert tcp any any -> any any (msg:"ICS Modbus Device Identification"; flow:to_server,established; content:"|2B|"; offset:7; depth:1; sid:9000021; rev:1;)
